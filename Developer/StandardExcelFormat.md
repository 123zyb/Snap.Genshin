# 可交换统一格式祈愿记录工作簿标准

> Uniformed Interchangeable GachaLog Workbook Format Standard

## 前言

由于原神的祈愿卡池与记录越来越多，越来越复杂，各个App间进行数据交换的代价越来越大，于是我们在此，与

* [Scighost/KeqingNiuza](https://github.com/Scighost/KeqingNiuza)

一起，制定了此项标准，旨在加强各个原神相关的App间的数据可交换性

## 注意

> 在采用此格式时，需要特别注意某些名称中可能存在的 `_` 下划线 与 空格  
> 此格式目前仅兼容简体中文环境下的App

## Excel文件的名称

虽然不需要此项的规定，但我们建议：

> 在名称中默认包含导出数据所属用户的 `uid`

## Excel表名及内容

* 如果有新的卡池种类，就新增祈愿表
* 表的顺序可以是任意的，甚至可以隐藏部分表

|表名 SheetName|内容 Content|是否必要|
|-|-|-|
|统计分析|统计分析内容|否|
|角色活动|`gacha_type` : `301\|400` 的祈愿数据|否，但是应该导出|
|武器活动|`gacha_type` : `302` 的祈愿数据|否，但是应该导出|
|常驻祈愿|`gacha_type` : `200` 的祈愿数据|否，但是应该导出|
|新手祈愿|`gacha_type` : `100` 的祈愿数据|否，但是应该导出|
|原始数据|全部祈愿数据|是|

> App间可以依据 原始数据表来互通数据


## 祈愿表结构

* 表头的名称可以有所不同，但表头的**顺序需要严格按照下方说明**排布
* 共享保底的卡池按祈愿类型 (`gacha_type`) 区分
* 此类 `Sheet` 存在的目的，是为了便于用户观看与祈愿分析工具的分析

|表头|内容|是否必要|
|-|-|-|
|时间|`yyyy-MM-dd HH:mm:ss` 格式的 `time` 时间|是|
|名称|`name`物品名称|是|
|物品类型|`gacha_type`|是|
|星级|`rank_type`|是|
|祈愿类型|`gacha_type`|是，尽管部分工具不会分析此项|
|祈愿Id|`id`|否|
|...|...|否|

> 如果你认为有必要的话，可以额外增加其他表头，但请确保表头的前几列为上表规范的内容

### 示例

|时间|名称|类别|星级|祈愿类型|祈愿 Id|总次数|保底内|
|-|-|-|-|-|-|-|-|
|2021-02-17 18:45:09|以理服人|武器|3|301|1613556360008291100|233|77|
|...|...|...|...|...|...|...|

## 原始数据表结构

* 以米哈游官方服务器返回的json结构为依据
* 表头的顺序无需严格按照下表设置
* 各个表头的名称需要严格按照下表
* 保持高度的向前与向后兼容性

|表头|是否必要|
|-|-|
|`count`|否，但是建议保留，不排除后续会有`count`不为1的情况|
|`gacha_type`|是|
|`id`|是，且大部分App按此字段排序数据|
|`item_id`|否，目前官方已经弃用了此字段|
|`item_type`|是|
|`lang`|否，但建议保留，以便国际化|
|`name`|是|
|`rank_type`|否，但建议保留，以便分析|
|`time`|否，但建议保留，以便分析|
|`uid`|否，但建议保留，以便分析|

> 若无特殊需求，我们建议导出所有json 数据内包含的字段

### 示例
|count|gacha_type|id|item_id|item_type|lang|name|rank_type|time|uid|
|-|-|-|-|-|-|-|-|-|-|
|1|301|1613556360008291100||武器|zh-cn|以理服人|3|2021-02-17 18:45:09|123456789|
|...|...|...|...|...|...|...|...|...|...|